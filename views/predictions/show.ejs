<!DOCTYPE html>
<html>
<head>
    <title>Prediction Details</title>
</head>
<body>
    <%- include('../partials/navbar') %>

    <h1>Prediction Details</h1>
    
    <% if (prediction.raceId) { %>
        <p>Date: <%= prediction.raceId.date.toDateString() %></p>
        <p>Circuit: <%= prediction.raceId.circuit %></p>
        <p>Country: <%= prediction.raceId.country %></p>
        <p>Status: <%= prediction.raceId.status %></p>
    <% } %>

    <h3>Your Predictions</h3>
    <p>Pole Position: <%= prediction.pole %></p>
    <p>Race Winner: <%= prediction.winner %></p>
    <p>Podium: <%= prediction.podium.join(', ') %></p>
    <p>Fastest Lap: <%= prediction.fastestLap %></p>
    <p>First DNF: <%= prediction.firstDNF %></p>
    <p>Confidence Level: <%= prediction.confidence %>%</p>
    <p>Prediction Made: <%= prediction.createdAt.toDateString() %></p>

    <% if (prediction.raceId && prediction.raceId.status === 'completed') { %>
        <h3>Race Results</h3>
        <% if (prediction.raceId.pole) { %><p>Actual Pole: <%= prediction.raceId.pole %></p><% } %>
        <% if (prediction.raceId.winner) { %><p>Actual Winner: <%= prediction.raceId.winner %></p><% } %>
        <% if (prediction.raceId.podium && prediction.raceId.podium.length > 0) { %>
            <p>Actual Podium: <%= prediction.raceId.podium.join(', ') %></p>
        <% } %>
        <% if (prediction.raceId.fastestLap) { %><p>Actual Fastest Lap: <%= prediction.raceId.fastestLap %></p><% } %>
        <% if (prediction.raceId.firstDNF) { %><p>Actual First DNF: Lap <%= prediction.raceId.firstDNF %></p><% } %>
        
        <h3>Your Score</h3>
        <p><strong>Points Earned: <%= prediction.points || 0 %>/50</strong></p>
    <% } %>

    <div>
        <a href="/predictions">Back to My Predictions</a>
        
        <% if (prediction.raceId && prediction.raceId.status === 'upcoming') { %>
            <a href="/predictions/<%= prediction._id %>/edit">Edit Prediction</a>
            <form method="POST" action="/predictions/<%= prediction._id %>?_method=DELETE" >
                <button type="submit" >Delete</button>
            </form>
        <% } %>
    </div>

</body>
</html>